@model SaniShop.Models.SalesDetailModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<script src="~/Scripts/jquery-1.10.2.js"></script>
<script src="~/Scripts/jquery-1.10.2.min.js"></script>
    <html>
    <body>
        <div class="body-right">
         @Html.ActionLink("Sales History", "Index", "Home")
        </div>

        <div>
            <table class="table" style="width:auto">
                <tr>
                    <td>Iteam </td>
                    <td>
                      @Html.DropDownListFor(m => m.Product_id, Model.Productname, "--Select One--", 
                       new { @class = "form-control", @onchange = "FillWatt()" })
                   
                    </td>
                </tr>
                <tr>
                    <td>Iteam </td>
                    <td>
                       @Html.DropDownListFor(m => m.wattmain,
                new SelectList(Enumerable.Empty<SelectListItem>(), "wattid", "wattmain"),
              "Select watt",
              new { @class = "form-control" })
                    </td>
                </tr>
                <tr>
                    <td>Iteam Discrption</td>
                    <td>
                        @Html.TextBoxFor(m => m.Description, new { @class = "inputComn" })
                    </td>
                </tr>                
                 <tr>
                    <td>Price(Per Iteam)</td>
                    <td>
                        @Html.TextBoxFor(m => m.Product_price, new { @class = "inputComn" })
                    </td>
                </tr>
                <tr>
                    <td>Quantity(In Count) </td>
                    <td>
                        @Html.TextBoxFor(m => m.Quantity, new { @class = "inputComn" })
                    </td>
                </tr>
                <tr>
                    <td>Total Amount</td>
                    <td>
                        @Html.TextBoxFor(m => m.TotalAmount, new { @class = "inputComn" })
                    </td>
                </tr>   
            </table>
            <table class="table" style="width:auto">
                <tr style="text-align:center">
        <td colspan="2" style="text-align:center">
            <input type="submit" id="Submit1" name="save" value="save" />
        </td>
    </tr>


</table>

        </div>

        <!-- Modal HTML -->
        <div id="myModal" class="modal fade">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title">Confirmation</h4>
                    </div>
                    <div class="modal-body">
                        <p>Data Saved Successfully !!!</p>                        
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal" id="Close">Close</button>                        
                    </div>
                </div>
            </div>
        </div>

    </body>
</html>

<script type="text/javascript">

    $(document).ready(function () {
        $("#Submit1").click(function () {
            return checkAuthentication();
        });
    });

    $("#Close").click(function () {
        return Refreshpage();
    });

    function Refreshpage() {
        $.ajax({
            url: '/Sales/Index',
            type: "GET",
            success: function (data) {
                jQuery.trim(jQuery('#Quantity').val(''));
                jQuery.trim(jQuery('#TotalAmount').val(''));
                jQuery.trim(jQuery('#Description').val(''));
                jQuery.trim(jQuery('#Product_price').val(''));
            }
        });
    }

        $("#dialog").dialog({
            autoOpen: false,
            modal: true,
            title: "Details",
            buttons: {
                Close: function () {
                    $(this).dialog('close');
                }
            }
        });
    function checkAuthentication() {
        var item = $("#Product_id option:selected").text();  //jQuery.trim(jQuery('#Product_id').text());
        var watt = $("#wattmain option:selected").text();  //jQuery.trim(jQuery('#wattmain').text());
        var quantity = jQuery.trim(jQuery('#Quantity').val());
        var totalamount = jQuery.trim(jQuery('#TotalAmount').val());
        var desc = jQuery.trim(jQuery('#Description').val());
        var price = jQuery.trim(jQuery('#Product_price').val());
        if (desc == "" && price == "") {
            alert('Please enter the discription and price')
            return false;
        }
        else {
            $.ajax({
                url: '/Sales/Index',
                type: "POST",
                dataType: "JSON",
                data: { Quantity: quantity, Item: item, Watts: watt, TotalAmo: totalamount, Desc: desc, Price: price },
                success: function (data) {                    
                    if (data.IsSuccess) {                     
                        $("#myModal").modal('show');
                    }                   
                 },
                error: function (jqXHR, textStatus, errorThrown) {
                    alert(errorThrown);
                }
            });
        }
    }
    function FillWatt() {
        var stateId = jQuery.trim(jQuery('#Product_id').val()); 
        $.ajax({
            url: '/Sales/FillWatt',
            type: "GET",
            dataType: "JSON",
            data: { State: stateId },
            success: function (data) {
                $("#wattmain").html(""); // clear before appending new list 
                $.each(data, function (i, watt) {
                    $("#wattmain").append(
                        $('<option></option>').val(watt.id).html(watt.watt));
                });
            }
        });
    }
</script>